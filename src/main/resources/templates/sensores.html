<html xmlns:th="http://www.thymeleaf.org" 
      xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Calculadora de Sensores</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>
    </head>
    <body>  
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <!--<a class="navbar-brand" th:href="@{/baterias}">Ingreso de dispositivo</a>-->            
            <a class="navbar-brand" th:href="@{/calculadora}">Calculadora Bateria</a>
            <a class="navbar-brand" th:href="@{/sensores}">Calculadora Sensores</a>
<!--            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <span class="navbar-text">Bienvenido, <span id="nicktext">Usuario</span>!</span>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-danger" onclick="cerrarSesion()">Cerrar Sesión</button>
                    </li>
                </ul>
            </div>-->
        </nav>
        <div class="container">
            <h2 class="center-text">Calculadora de Sensores</h2>
            <div class="row">

                <!--                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="id_sensores">Id</label>
                                        <input id="id_sensores" type="number"  name="id_sensores" class="form-control" disabled="true"/>
                                    </div>
                                </div>            -->
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="longitudInput">Distancia(metros)</label>
                        <input id="longitud" type="number" placeholder="Ingrese la distancia" name="longitud" class="form-control"/>
                    </div>
                </div>
                <!--                <div class="col-md-3">
                                    <div class="form-group">
                                        <label for="altitudInput">Archo:</label>
                                        <input id="ancho" type="number" name="ancho" placeholder="Ingrese el Ancho de la habitación"  class="form-control"/>
                                    </div>
                                </div>-->

                <div class="col-md-2">
                    <div class="form-group">                        
                        <label style="min-height: 1.4em;" class="empty-label" for="button"></label>

                        <button type="submit" class="btn btn-primary btn-block" onclick="calcularSensores()" >Calcular</button>
                    </div>
                </div>    
            </div>

            <div class="result-grid">
                <div>
                    <label for="altitudResultado">Distancia:</label>
                    <span id="altitudResultado">---</span>
                </div>
                <!--                <div>
                                    <label for="latitudResultado">Ancho:</label>
                                    <span id="latitudResultado">---</span>
                                </div>-->
                <div>
                    <label for="cantidadSensoresResultado">Cantidad de Sensores:</label>
                    <span id="cantidadSensoresResultado">---</span>
                </div>
                <div>
                    <label for="separacionParedResultado">Separación de Sensor a Pared:</label>
                    <span id="separacionParedResultado">---</span>
                </div>
                <div>
                    <label for="separacionSensoresResultado">Separación entre Sensores:</label>
                    <span id="separacionSensoresResultado">---</span>
                </div>
            </div>
            <!--            <h2 class="center-text">Resultados</h2>
                        <table id="tablaSensores" class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Id</th>
                                    <th>Longitud</th>
                                    <th>Ancho</th>
                                    <th>Cantidad de Sensores</th>
                                    <th>Separación de Sensor a Pared</th>
                                    <th>Separación entre Sensores</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>-->
        </div>
        <!-- JavaScript para la funcionalidad de cálculo -->
        <script>
            window.onload = function () {
//                obtenerSensores();
            };
//            function obtenerSensores() {
//                fetch('/sensor')  // Realiza una solicitud GET a la ruta '/sensores'
//                        .then(response => response.json())  // Parsea la respuesta a JSON
//                        .then(sensores => {
//                            var tablaSensores = document.getElementById('tablaSensores').getElementsByTagName('tbody')[0];
//
//                            // Limpiar la tabla antes de agregar los nuevos datos
//                            tablaSensores.innerHTML = '';
//
//                            sensores.forEach(sensor => {
//                                var fila = tablaSensores.insertRow();
//
//                                // Crear las celdas de la fila con los datos del sensor
//                                var idCell = fila.insertCell(0);
//                                var longitudCell = fila.insertCell(1);
//                                var anchoCell = fila.insertCell(2);
//                                var cantSensoresCell = fila.insertCell(3);
//                                var separacionParedCell = fila.insertCell(4);
//                                var separacionSensoresCell = fila.insertCell(5);
//                                var accionesCell = fila.insertCell(6); // Nueva celda para acciones
//
//                                // Llenar las celdas con los datos
//                                idCell.innerHTML = sensor.id_sensor;
//                                longitudCell.innerHTML = sensor.longitud.toFixed(2);
//                                anchoCell.innerHTML = sensor.ancho.toFixed(2);
//                                cantSensoresCell.innerHTML = sensor.cant_sensores;
//                                separacionParedCell.innerHTML = sensor.sepa_pared.toFixed(2);
//                                separacionSensoresCell.innerHTML = sensor.sepa_sensor.toFixed(2);
//
//                                accionesCell.innerHTML = `
//                    <button class="btn btn-sm btn-primary" onclick="editarSensor(${sensor.id_sensor})">Editar</button>
//                    <button class="btn btn-sm btn-danger" onclick="eliminarSensor(${sensor.id_sensor})">Eliminar</button>
//                `;
//                            });
//                        })
//                        .catch(error => {
//                            console.error('Error en la solicitud:', error);
//                        });
//            }
//            function eliminarSensor(idSensor) {
//                fetch(`/sensor/${idSensor}`, {
//                    method: 'DELETE'
//                })
//                        .then(response => {
//                            if (response.ok) {
//                                alert('Sensor eliminado correctamente');
//                                limpiarFormulario()
//                                obtenerSensores(); // Actualizar la tabla después de eliminar
//                            } else {
//                                console.log('Error al eliminar el sensor');
//                            }
//                        })
//                        .catch(error => {
//                            console.error('Error en la solicitud:', error);
//                        });
//            }

//            function editarSensor(idSensor) {
//                // Realizar una solicitud GET para obtener los datos del sensor por su ID
//                fetch(`/sensor/${idSensor}`)
//                        .then(response => response.json())
//                        .then(sensor => {
//                            var idInput = document.getElementById("id_sensores");
//                            var longitudInput = document.getElementById("longitud");
//                            var anchoInput = document.getElementById("ancho");
//
//                            idInput.value = sensor.id_sensor;
//                            longitudInput.value = sensor.longitud.toFixed(2);
//                            anchoInput.value = sensor.ancho.toFixed(2);
//
//                            // Cambiar el texto del botón a "Actualizar"
//                            var botonCalcular = document.querySelector("button[type='submit']");
//                            botonCalcular.textContent = "Actualizar";
//                        })
//                        .catch(error => {
//                            console.error('Error en la solicitud:', error);
//                        });
//            }




            function calcularSensores() {
                var longitudInput = document.getElementById("longitud");
                var longitud = parseFloat(longitudInput.value);

                if (isNaN(longitud) || longitud <= 0) {
                    alert("Por favor, ingrese un valor válido y no negativo para la distancia.");
                    return;
                }

                var area = longitud;
                var cant_sens = area / 9;
                var cant_sensores = Math.ceil(cant_sens);

                var sensor_pared = area / cant_sensores;
                var sensor_sensor = sensor_pared / 2;

                // Ajustar valores si cant_sensores es igual a 1
                if (cant_sensores === 1) {
                    sensor_pared /= 2;
                    sensor_sensor = sensor_pared;
                }

                document.getElementById("altitudResultado").textContent = longitud.toFixed(2);
                document.getElementById("cantidadSensoresResultado").textContent = cant_sensores;
                document.getElementById("separacionParedResultado").textContent = sensor_pared.toFixed(2);
                document.getElementById("separacionSensoresResultado").textContent = sensor_sensor.toFixed(2);
            }
            function limpiarFormulario() {
                document.getElementById("id_sensores").value = "";
                document.getElementById("longitud").value = "";
                document.getElementById("ancho").value = "";
                document.getElementById("altitudResultado").textContent = "---";
                document.getElementById("latitudResultado").textContent = "---";
                document.getElementById("cantidadSensoresResultado").textContent = "---";
                document.getElementById("separacionParedResultado").textContent = "---";
                document.getElementById("separacionSensoresResultado").textContent = "---";
                var botonCalcular = document.querySelector("button[type='submit']");
                botonCalcular.textContent = "Calcular";
            }

            function cerrarSesion() {
                // Redirige a la página de inicio de sesión
                window.location.href = "cerrar-sesion";
            }

        </script>
    </body>
</html>
